#  CPBS Module4 Day3 Assignment 

## Overview
The python script generates a population of disease associated subnetworks; optimizes using a genetic algorithm; computes statistical significance and generates gene scores:<br>
- Generate 5000 random subnetworks with disease associated genes (one gene from each loci)
- Optimize using genetic algorithm comprising:
- a) Mutation step: use the parent subnetwork and muatate genes in loci with a 5% probability and compute normalized edge weights
- b) Mating step: Sample pairs of subnetworks with probabilities as edge weights from (a) and the child subnetwork has genes randomly selected from either parent
- Optimization terminates when the percentage difference between current and previous population is less than 0.5
- Generate non-informative null case using quantile binning. The initial population is generated by replacing FA gene (disease-associated) by a non-FA (non-disease associated) gene from the same bin group.
- Assign random loci for non-FA gene (and this is different for each population)
- The initial population is subjected to the same genetic algorithm and 1000 final populations are generated. The test statistic for null case is computed as the average edge weight for the population.
- p-values are computed for each subnetwork in the optimized FA population. p-value is the number of times of 1000, the test statistic in null case is as extreme or more extreme to that of the FA subnetwork. 
- Compute raw candidate gene scores by replacing the representative gene in the optimized FA subnetworks with every other gene in the loci and calculating the average edge weights
- Compute empty case by counting the number of edges without the current loci
- Subtract raw candidate gene scores with the empty case
- Compute the average gene scores across 5000 subnetworks for all the genes
- If a gene doesn't exist in the parent subnetwork, give it an 'NA' score

## Input Arguments

There are two input files:<br> 
- -i or --input: Disease genes file in Gene Map Table (GMT) format from OMIM <br>
- -n or --network: Protein protein interactions network, for example, from STRING database. Column1 is gene1, column2 is gene2, column3 is edge<br>

Arguments:
- nSub: Number of subnetworks. Default is 5000 <br>
- minEdges: Number of minimum Edges for the subnetwork to be considered. Default is 0 <br>
- nbins: Number of bins for quantile binning
- nSubViz: First N subnetworks to visualize. Default is 200 <br>

## Output files

- network.png
- FA_subnetwork.txt
- gene_scores.txt

## Usage

`python Subnetworks_GeneScore.py Disease_gene_file.txt Protein_Protein_Interaction.txt --nSub --minEdges --nSubViz`

Example:

`python Subnetworks.py Input.gmt.txt STRING 1.txt --nSub 5000 --minEdges 0 --nSubViz 200`

## Additional Documentation